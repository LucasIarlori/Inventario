<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pañol digital</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 10px;
            max-width: 500px;
            margin: auto;
        }
        h1 {
            color: #333;
            font-size: 24px;
            text-align: center;
        }
        .tabs {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }
        .tabs button {
            flex: 1;
            padding: 12px;
            border: none;
            border-bottom: 2px solid transparent;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
            outline: none;
        }
        .tabs button.active {
            border-bottom: 2px solid #fff;
            background-color: #fff;
            font-weight: bold;
            color: #333;
        }
        #agregarTabBtn {
            background-color: #28a745; /* Verde */
        }
        #inventarioTabBtn {
            background-color: #007bff; /* Azul */
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        button {
            flex: 1;
            padding: 12px;
            margin: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
        }
        button:hover {
            opacity: 0.9;
        }
        #btnIngresar {
            background-color: #28a745; /* Verde */
        }
        #btnRetirar {
            background-color: #dc3545; /* Rojo */
        }
        ul {
            list-style-type: none;
            padding: 0;
        }
        li {
            background-color: #fff;
            padding: 10px;
            margin-bottom: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
            display: flex;
            flex-direction: column;
            font-size: 16px;
        }
        .material-name {
            font-weight: bold;
        }
        .time-info {
            font-size: 14px;
            color: #555;
        }
        button.small-btn {
            padding: 5px 10px;
            font-size: 14px;
            margin-top: 5px;
            background-color: #dc3545; /* Rojo para eliminar */
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Pañol digital</h1>
    <div class="tabs">
        <button id="agregarTabBtn" class="tab-link active" onclick="openTab(event, 'agregarTab')">Agregar</button>
        <button id="inventarioTabBtn" class="tab-link" onclick="openTab(event, 'inventarioTab')">Inventario</button>
    </div>

    <div id="agregarTab" class="tab-content active">
        <button id="btnIngresar">Ingresar</button>
        <button id="btnRetirar">Retirar</button>
    </div>

    <div id="inventarioTab" class="tab-content">
        <ul id="listaMateriales"></ul>
    </div>

    <script>
        const listaMateriales = document.getElementById('listaMateriales');
        const materiales = {};

        // Función para cambiar entre pestañas
        function openTab(evt, tabName) {
            if (tabName === 'inventarioTab' && !verificarClave()) {
                alert("Clave incorrecta para acceder al inventario.");
                return;
            }

            const tabContents = document.getElementsByClassName("tab-content");
            const tabLinks = document.getElementsByClassName("tab-link");

            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove("active");
            }

            for (let i = 0; i < tabLinks.length; i++) {
                tabLinks[i].classList.remove("active");
            }

            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }

        // Función para verificar la clave
        function verificarClave() {
            const clave = prompt("Ingrese la clave:");
            return clave === "123";
        }

        // Función para obtener la fecha y hora actuales en formato legible
        function obtenerFechaHora() {
            const now = new Date();
            return now.toLocaleDateString() + ' ' + now.toLocaleTimeString();
        }

        // Función para abrir una ventana emergente para ingresar materiales
        document.getElementById('btnIngresar').addEventListener('click', function() {
            if (!verificarClave()) {
                alert("Clave incorrecta para ingresar materiales.");
                return;
            }

            const nombre = prompt("Ingrese el nombre del material:");
            if (nombre === null || nombre.trim() === "") return;

            const cantidad = parseInt(prompt("Ingrese la cantidad:"));
            if (isNaN(cantidad) || cantidad <= 0) return;

            const materialKey = nombre.trim().toLowerCase();
            const fechaHoraIngreso = obtenerFechaHora();

            if (materiales[materialKey]) {
                materiales[materialKey].cantidad += cantidad;
                materiales[materialKey].elemento.querySelector('.cantidad').textContent = `${materiales[materialKey].cantidad}`;
                materiales[materialKey].elemento.querySelector('.ingreso').textContent = `Ingreso: ${fechaHoraIngreso}`;
            } else {
                const li = document.createElement('li');
                li.innerHTML = `
                    <span class="material-name">${nombre}</span>
                    <span class="cantidad">Cantidad: ${cantidad}</span>
                    <span class="time-info ingreso">Ingreso: ${fechaHoraIngreso}</span>
                    <span class="time-info retiro">Retiro: -</span>
                `;

                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = 'Eliminar';
                deleteBtn.classList.add('small-btn');
                deleteBtn.addEventListener('click', function() {
                    if (!verificarClave()) {
                        alert("Clave incorrecta para eliminar materiales.");
                        return;
                    }
                    listaMateriales.removeChild(li);
                    delete materiales[materialKey];
                });

                li.appendChild(deleteBtn);
                listaMateriales.appendChild(li);

                materiales[materialKey] = {
                    cantidad: cantidad,
                    fechaHoraIngreso: fechaHoraIngreso,
                    elemento: li
                };
            }
        });

        // Función para retirar materiales
        document.getElementById('btnRetirar').addEventListener('click', function() {
            if (!verificarClave()) {
                alert("Clave incorrecta para retirar materiales.");
                return;
            }

            const nombre = prompt("Ingrese el nombre del material a retirar:");
            if (nombre === null || nombre.trim() === "") return;

            const cantidad = parseInt(prompt("Ingrese la cantidad a retirar:"));
            if (isNaN(cantidad) || cantidad <= 0) return;

            const materialKey = nombre.trim().toLowerCase();
            const fechaHoraRetiro = obtenerFechaHora();

            if (materiales[materialKey]) {
                if (materiales[materialKey].cantidad >= cantidad) {
                    materiales[materialKey].cantidad -= cantidad;
                    materiales[materialKey].elemento.querySelector('.cantidad').textContent = `${materiales[materialKey].cantidad}`;
                    materiales[materialKey].elemento.querySelector('.retiro').textContent = `Retiro: ${fechaHoraRetiro}`;

                    if (materiales[materialKey].cantidad === 0) {
                        listaMateriales.removeChild(materiales[materialKey].elemento);
                        delete materiales[materialKey];
                    }
                } else {
                    alert("Cantidad insuficiente en inventario.");
                }
            } else {
                alert("El material no existe en el inventario.");
            }
        });
    </script>
</body>
</html>
